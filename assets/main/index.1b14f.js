window.__require=function e(t,i,c){function o(s,a){if(!i[s]){if(!t[s]){var r=s.split("/");if(r=r[r.length-1],!t[r]){var h="function"==typeof __require&&__require;if(!a&&h)return h(r,!0);if(n)return n(r,!0);throw new Error("Cannot find module '"+s+"'")}s=r}var p=i[s]={exports:{}};t[s][0].call(p.exports,function(e){return o(t[s][1][e]||e)},p,p.exports,e,t,i,c)}return i[s].exports}for(var n="function"==typeof __require&&__require,s=0;s<c.length;s++)o(c[s]);return o}({Game:[function(e,t){"use strict";cc._RF.push(t,"3c927u5XcpAyZLEh28wGE1w","Game"),cc.Class({extends:cc.Component,properties:{starPrefab:{default:null,type:cc.Prefab},scoreDisplay:{default:null,type:cc.Label,tooltip:"\u5f97\u5206\u663e\u793aLabel\u7ec4\u4ef6"},scoreAudio:{default:null,type:cc.AudioClip,tooltip:"\u5f97\u5206\u97f3\u6548"},failAudio:{default:null,type:cc.AudioClip,tooltip:"\u5931\u8d25\u97f3\u6548"},timerDisplay:{default:null,type:cc.Label,tooltip:"\u5012\u8ba1\u65f6\u663e\u793aLabel\u7ec4\u4ef6"},gameOverNode:{default:null,type:cc.Node,tooltip:"\u6e38\u620f\u7ed3\u675f\u8282\u70b9"},moveSpeed:{default:100,type:cc.Float,tooltip:"\u661f\u661f\u79fb\u52a8\u901f\u5ea6"},directionChangeInterval:{default:2,type:cc.Float,tooltip:"\u661f\u661f\u6539\u53d8\u65b9\u5411\u7684\u65f6\u95f4\u95f4\u9694"},maxStarCount:{default:3,type:cc.Integer,tooltip:"\u573a\u666f\u4e2d\u6700\u5927\u661f\u661f\u6570\u91cf"},spawnInterval:{default:2,type:cc.Float,tooltip:"\u661f\u661f\u91cd\u751f\u65f6\u95f4"},gameTime:{default:30,type:cc.Integer,tooltip:"\u6e38\u620f\u603b\u65f6\u95f4"},targetScore:{default:15,type:cc.Integer,tooltip:"\u76ee\u6807\u5206\u6570"}},onLoad:function(){cc.director.getCollisionManager().enabled=!0,this.screenSize=cc.view.getVisibleSize(),this.minX=-this.screenSize.width/2,this.maxX=this.screenSize.width/2,this.minY=-this.screenSize.height/2,this.maxY=this.screenSize.height/2,this.initGame()},initGame:function(){this.score=0,this.updateScore(),this.timer=this.gameTime,this.updateTimer(),this.spawnTimers=[],this.gameOverNode&&(this.gameOverNode.active=!1),this.node.removeAllChildren();for(var e=0;e<this.maxStarCount;e++)this.spawnNewStar();this.isGameRunning=!0},updateTimer:function(){this.timerDisplay&&(this.timerDisplay.string="Time: "+Math.ceil(this.timer))},gameOver:function(){this.isGameRunning=!1,this.gameOverNode&&(this.gameOverNode.active=!0),this.node.children.forEach(function(e){e.moveDir=cc.v2(0,0)}),this.score<this.targetScore&&this.failAudio&&cc.audioEngine.playEffect(this.failAudio,!1)},restartGame:function(){this.initGame()},updateScore:function(){this.scoreDisplay&&(this.scoreDisplay.string="Score: "+this.score)},gainScore:function(){this.score+=1,this.updateScore(),this.scoreAudio&&cc.audioEngine.playEffect(this.scoreAudio,!1),this.score>=this.targetScore&&this.gameOver()},getRandomPosition:function(){var e=Math.random()*(this.screenSize.width-100)-(this.screenSize.width/2-50),t=Math.random()*(this.maxY+120-50)-120+50;return cc.v2(e,t)},getRandomDirection:function(){var e=Math.random()*Math.PI*2;return cc.v2(Math.cos(e),Math.sin(e))},spawnNewStar:function(){if(!(this.node.children.filter(function(e){return"star"===e.name}).length>=this.maxStarCount)){var e=cc.instantiate(this.starPrefab);if(e){this.node.addChild(e),e.setPosition(this.getRandomPosition()),e.name="star",e.moveDir=this.getRandomDirection();var t=e.addComponent(cc.CircleCollider);t.radius=25,t.offset=cc.v2(0,0),e.nextDirectionChange=this.directionChangeInterval,cc.log("\u661f\u661f\u5df2\u521b\u5efa - \u4f4d\u7f6e:",e.position)}else cc.error("\u661f\u661f\u9884\u5236\u4f53\u521b\u5efa\u5931\u8d25!")}},delayedSpawnStar:function(){this.spawnTimers.push(this.spawnInterval)},update:function(e){var t=this;if(this.isGameRunning){if(this.timer-=e,this.updateTimer(),this.timer<=0)return this.timer=0,this.updateTimer(),void this.gameOver();this.node.children.filter(function(e){return"star"===e.name}).forEach(function(i){i.nextDirectionChange-=e,i.nextDirectionChange<=0&&(i.moveDir=t.getRandomDirection(),i.nextDirectionChange=t.directionChangeInterval);var c=i.position;c.x+=i.moveDir.x*t.moveSpeed*e,c.y+=i.moveDir.y*t.moveSpeed*e,c.x<=t.minX+50?(c.x=t.minX+50,i.moveDir.x*=-1):c.x>=t.maxX-50&&(c.x=t.maxX-50,i.moveDir.x*=-1),c.y<=-120?(c.y=-120,i.moveDir.y*=-1):c.y>=t.maxY-50&&(c.y=t.maxY-50,i.moveDir.y*=-1),i.setPosition(c)});for(var i=this.spawnTimers.length-1;i>=0;i--)this.spawnTimers[i]-=e,this.spawnTimers[i]<=0&&(this.spawnTimers.splice(i,1),this.spawnNewStar())}}}),cc._RF.pop()},{}],NewStar:[function(e,t){"use strict";cc._RF.push(t,"abfa1kxkNBGOZtQ+ciTT103","NewStar"),cc.Class({extends:cc.Component,properties:{pickRadius:0},start:function(){}}),cc._RF.pop()},{}],Player:[function(e,t){"use strict";cc._RF.push(t,"db8ebwcRcZBo6VTi5YGFnIz","Player"),cc.Class({extends:cc.Component,properties:{jumpHeight:{default:200,type:cc.Float},jumpDuration:{default:.3,type:cc.Float},jumpAudio:{default:null,type:cc.AudioClip,tooltip:"\u8df3\u8dc3\u97f3\u6548"},maxMoveSpeed:{default:400,type:cc.Float},accel:{default:1e3,type:cc.Float},minX:{default:-480,type:cc.Float,tooltip:"\u6700\u5c0f X \u5750\u6807"},maxX:{default:480,type:cc.Float,tooltip:"\u6700\u5927 X \u5750\u6807"}},onLoad:function(){this.xSpeed=0,this.ySpeed=0,this.accLeft=!1,this.accRight=!1,this.accUp=!1,this.accDown=!1,this.isJumping=!1,cc.find("Canvas").getComponent(cc.Canvas);var e=cc.view.getVisibleSize();this.minX=-e.width/2+this.node.width/2,this.maxX=e.width/2-this.node.width/2,cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this);var t=this.node.addComponent(cc.CircleCollider);t.radius=40,t.offset=cc.v2(0,0),console.log("Player component loaded")},onKeyDown:function(e){switch(console.log("Key down:",e.keyCode),e.keyCode){case cc.macro.KEY.a:case cc.macro.KEY.left:this.accLeft=!0;break;case cc.macro.KEY.d:case cc.macro.KEY.right:this.accRight=!0;break;case cc.macro.KEY.w:case cc.macro.KEY.up:this.accUp=!0;break;case cc.macro.KEY.s:case cc.macro.KEY.down:this.accDown=!0;break;case cc.macro.KEY.space:this.isJumping||(this.jump(),this.isJumping=!0)}},onKeyUp:function(e){switch(console.log("Key up:",e.keyCode),e.keyCode){case cc.macro.KEY.a:case cc.macro.KEY.left:this.accLeft=!1;break;case cc.macro.KEY.d:case cc.macro.KEY.right:this.accRight=!1;break;case cc.macro.KEY.w:case cc.macro.KEY.up:this.accUp=!1;break;case cc.macro.KEY.s:case cc.macro.KEY.down:this.accDown=!1}},jump:function(){this.jumpAudio&&cc.audioEngine.playEffect(this.jumpAudio,!1),this.jumpAction&&this.node.stopAction(this.jumpAction);var e=cc.moveBy(this.jumpDuration,cc.v2(0,this.jumpHeight)).easing(cc.easeCubicActionOut()),t=cc.moveBy(this.jumpDuration,cc.v2(0,-this.jumpHeight)).easing(cc.easeCubicActionIn()),i=cc.callFunc(function(){this.isJumping=!1},this);this.jumpAction=cc.sequence(e,t,i),this.node.runAction(this.jumpAction)},update:function(e){(this.accLeft||this.accRight)&&console.log("Moving, xSpeed:",this.xSpeed),this.accLeft?this.xSpeed-=this.accel*e:this.accRight?this.xSpeed+=this.accel*e:this.xSpeed=.9*this.xSpeed,Math.abs(this.xSpeed)>this.maxMoveSpeed&&(this.xSpeed=this.maxMoveSpeed*(this.xSpeed>0?1:-1));var t=this.node.x+this.xSpeed*e;t<this.minX?(t=this.minX,this.xSpeed=0):t>this.maxX&&(t=this.maxX,this.xSpeed=0),this.node.x=t},onDestroy:function(){cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this)},onCollisionEnter:function(e){if("star"===e.node.name){e.node.destroy();var t=cc.find("Canvas/Game").getComponent("Game");t&&(t.gainScore(),t.delayedSpawnStar())}}}),cc._RF.pop()},{}],"use_v2.0.x_cc.Toggle_event":[function(e,t){"use strict";cc._RF.push(t,"227394BlV9JoqX+hs9WTxjt","use_v2.0.x_cc.Toggle_event"),cc.Toggle&&(cc.Toggle._triggerEventInScript_check=!0),cc._RF.pop()},{}]},{},["use_v2.0.x_cc.Toggle_event","Game","NewStar","Player"]);